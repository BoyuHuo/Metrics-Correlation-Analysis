<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BooleanConverter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Apache Commons BeanUtils</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.beanutils2.converters</a> &gt; <span class="el_source">BooleanConverter.java</span></div><h1>BooleanConverter.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.commons.beanutils2.converters;

/**
 * {@link org.apache.commons.beanutils2.Converter} implementation that handles conversion
 * to and from &lt;b&gt;Boolean&lt;/b&gt; objects.
 * {@link org.apache.commons.beanutils2.Converter} implementation that
 * handles conversion to and from &lt;b&gt;java.lang.Boolean&lt;/b&gt; objects.
 * &lt;p&gt;
 * Can be configured to either return a &lt;i&gt;default value&lt;/i&gt; or throw a
 * &lt;code&gt;ConversionException&lt;/code&gt; if a conversion error occurs.
 * &lt;/p&gt;
 * &lt;p&gt;
 * By default any object whose string representation is one of the values
 * {&quot;yes&quot;, &quot;y&quot;, &quot;true&quot;, &quot;on&quot;, &quot;1&quot;} is converted to Boolean.TRUE, and
 * string representations {&quot;no&quot;, &quot;n&quot;, &quot;false&quot;, &quot;off&quot;, &quot;0&quot;} are converted
 * to Boolean.FALSE. The recognized true/false strings can be changed by:
 * &lt;/p&gt;
 * &lt;pre&gt;
 *  String[] trueStrings = {&quot;oui&quot;, &quot;o&quot;, &quot;1&quot;};
 *  String[] falseStrings = {&quot;non&quot;, &quot;n&quot;, &quot;0&quot;};
 *  Converter bc = new BooleanConverter(trueStrings, falseStrings);
 *  ConvertUtils.register(bc, Boolean.class);
 *  ConvertUtils.register(bc, Boolean.TYPE);
 * &lt;/pre&gt;
 *
 * &lt;p&gt;Case is ignored when converting values to true or false.&lt;/p&gt;
 *
 * @version $Id$
 * @since 1.3
 */
public final class BooleanConverter extends AbstractConverter {


    // ----------------------------------------------------------- Constructors


    /**
     * Create a {@link org.apache.commons.beanutils2.Converter} that will throw a
     * {@link org.apache.commons.beanutils2.ConversionException}
     * if a conversion error occurs, ie the string value being converted is
     * not one of the known true strings, nor one of the known false strings.
     */
    public BooleanConverter() {
<span class="fc" id="L60">        super();</span>
<span class="fc" id="L61">    }</span>


    /**
     * Create a {@link org.apache.commons.beanutils2.Converter} that will return the specified default value
     * if a conversion error occurs, ie the string value being converted is
     * not one of the known true strings, nor one of the known false strings.
     *
     * @param defaultValue The default value to be returned if the value
     *  being converted is not recognized. This value may be null, in which
     *  case null will be returned on conversion failure. When non-null, it is
     *  expected that this value will be either Boolean.TRUE or Boolean.FALSE.
     *  The special value BooleanConverter.NO_DEFAULT can also be passed here,
     *  in which case this constructor acts like the no-argument one.
     */
    public BooleanConverter(final Object defaultValue) {
<span class="fc" id="L77">        super(defaultValue);</span>
<span class="fc" id="L78">    }</span>

    /**
     * Create a {@link org.apache.commons.beanutils2.Converter} that will throw a
     * {@link org.apache.commons.beanutils2.ConversionException}
     * if a conversion error occurs, ie the string value being converted is
     * not one of the known true strings, nor one of the known false strings.
     * &lt;p&gt;
     * The provided string arrays are copied, so that changes to the elements
     * of the array after this call is made do not affect this object.
     *
     * @param trueStrings is the set of strings which should convert to the
     *  value Boolean.TRUE. The value null must not be present. Case is
     *  ignored.
     *
     * @param falseStrings is the set of strings which should convert to the
     *  value Boolean.TRUE. The value null must not be present. Case is
     *  ignored.
     * @since 1.8.0
     */
    public BooleanConverter(final String[] trueStrings, final String[] falseStrings) {
<span class="fc" id="L99">        super();</span>
<span class="fc" id="L100">        this.trueStrings = copyStrings(trueStrings);</span>
<span class="fc" id="L101">        this.falseStrings = copyStrings(falseStrings);</span>
<span class="fc" id="L102">    }</span>

    /**
     * Create a {@link org.apache.commons.beanutils2.Converter} that will return
     * the specified default value if a conversion error occurs.
     * &lt;p&gt;
     * The provided string arrays are copied, so that changes to the elements
     * of the array after this call is made do not affect this object.
     *
     * @param trueStrings is the set of strings which should convert to the
     *  value Boolean.TRUE. The value null must not be present. Case is
     *  ignored.
     *
     * @param falseStrings is the set of strings which should convert to the
     *  value Boolean.TRUE. The value null must not be present. Case is
     *  ignored.
     *
     * @param defaultValue The default value to be returned if the value
     *  being converted is not recognized. This value may be null, in which
     *  case null will be returned on conversion failure. When non-null, it is
     *  expected that this value will be either Boolean.TRUE or Boolean.FALSE.
     *  The special value BooleanConverter.NO_DEFAULT can also be passed here,
     *  in which case an exception will be thrown on conversion failure.
     * @since 1.8.0
     */
    public BooleanConverter(final String[] trueStrings, final String[] falseStrings,
                final Object defaultValue) {
<span class="nc" id="L129">        super(defaultValue);</span>
<span class="nc" id="L130">        this.trueStrings = copyStrings(trueStrings);</span>
<span class="nc" id="L131">        this.falseStrings = copyStrings(falseStrings);</span>
<span class="nc" id="L132">    }</span>


    // ----------------------------------------------------- Static Variables


    


    // ----------------------------------------------------- Instance Variables

    /**
     * The set of strings that are known to map to Boolean.TRUE.
     */
<span class="pc" id="L146">    private String[] trueStrings = {&quot;true&quot;, &quot;yes&quot;, &quot;y&quot;, &quot;on&quot;, &quot;1&quot;};</span>

    /**
     * The set of strings that are known to map to Boolean.FALSE.
     */
<span class="pc" id="L151">    private String[] falseStrings = {&quot;false&quot;, &quot;no&quot;, &quot;n&quot;, &quot;off&quot;, &quot;0&quot;};</span>

    // --------------------------------------------------------- Protected Methods

    /**
     * Return the default type this &lt;code&gt;Converter&lt;/code&gt; handles.
     *
     * @return The default type this &lt;code&gt;Converter&lt;/code&gt; handles.
     * @since 1.8.0
     */
    @Override
    protected Class&lt;Boolean&gt; getDefaultType() {
<span class="fc" id="L163">        return Boolean.class;</span>
    }

    /**
     * Convert the specified input object into an output object of the
     * specified type.
     *
     * @param &lt;T&gt; Target type of the conversion.
     * @param type is the type to which this value should be converted. In the
     *  case of this BooleanConverter class, this value is ignored.
     *
     * @param value is the input value to be converted. The toString method
     *  shall be invoked on this object, and the result compared (ignoring
     *  case) against the known &quot;true&quot; and &quot;false&quot; string values.
     *
     * @return Boolean.TRUE if the value was a recognized &quot;true&quot; value,
     *  Boolean.FALSE if the value was a recognized &quot;false&quot; value, or
     *  the default value if the value was not recognized and the constructor
     *  was provided with a default value.
     *
     * @throws Throwable if an error occurs converting to the specified type
     * @since 1.8.0
     */
    @Override
    protected &lt;T&gt; T convertToType(final Class&lt;T&gt; type, final Object value) throws Throwable {

<span class="pc bpc" id="L189" title="1 of 4 branches missed.">        if (Boolean.class.equals(type) || Boolean.TYPE.equals(type)) {</span>
            // All the values in the trueStrings and falseStrings arrays are
            // guaranteed to be lower-case. By converting the input value
            // to lowercase too, we can use the efficient String.equals method
            // instead of the less-efficient String.equalsIgnoreCase method.
<span class="fc" id="L194">            final String stringValue = value.toString().toLowerCase();</span>

<span class="fc bfc" id="L196" title="All 2 branches covered.">            for (final String trueString : trueStrings) {</span>
<span class="fc bfc" id="L197" title="All 2 branches covered.">                if (trueString.equals(stringValue)) {</span>
<span class="fc" id="L198">                    return type.cast(Boolean.TRUE);</span>
                }
            }

<span class="fc bfc" id="L202" title="All 2 branches covered.">            for (final String falseString : falseStrings) {</span>
<span class="fc bfc" id="L203" title="All 2 branches covered.">                if (falseString.equals(stringValue)) {</span>
<span class="fc" id="L204">                    return type.cast(Boolean.FALSE);</span>
                }
            }
        }

<span class="fc" id="L209">        throw conversionException(type, value);</span>
    }

    /**
     * This method creates a copy of the provided array, and ensures that
     * all the strings in the newly created array contain only lower-case
     * letters.
     * &lt;p&gt;
     * Using this method to copy string arrays means that changes to the
     * src array do not modify the dst array.
     */
    private static String[] copyStrings(final String[] src) {
<span class="fc" id="L221">        final String[] dst = new String[src.length];</span>
<span class="fc bfc" id="L222" title="All 2 branches covered.">        for(int i=0; i&lt;src.length; ++i) {</span>
<span class="fc" id="L223">            dst[i] = src[i].toLowerCase();</span>
        }
<span class="fc" id="L225">        return dst;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>